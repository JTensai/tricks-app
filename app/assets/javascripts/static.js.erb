jQuery(function() {
  const images = [
    '<%= image_url "site_header_images/Folsom/IMG_7786.jpg" %>',
    '<%= image_url "site_header_images/Folsom/IMG_7790.jpg" %>',
    '<%= image_url "site_header_images/Folsom/IMG_7792.jpg" %>',
    '<%= image_url "site_header_images/Sacramento/IMG_7840.jpg" %>',
    '<%= image_url "site_header_images/Sacramento/IMG_7839.jpg" %>',
    '<%= image_url "site_header_images/Sacramento/IMG_7827.jpg" %>'
  ]

  const img = $('#background_image_loader');
  let i = 0;
  img.prop('src', images[0]);
  
  const changeBackgroundImage = function() {
    if (img.prop('complete')) {
      swap();
    } else {
      img.one('load', function() {
        swap();
      });
    }
  };

  const swap = function() {
    $('#background_images').fadeOut(500, function() {
      $('#background_images').css('background-image', "url("+images[i]+")");
      return $('#background_images').fadeIn(1000, function() {
        return setTimeout(changeBackgroundImage, 5000);
      });
    });
    i = i + 1;
    if (i === images.length) {
      i = 0;
    }
    img.prop('src', images[0]);
  };

  const updateOrbitSize = function() {
    $('.orbit-container').each(function(i, obj) {
      $(this).height($(this).width() * (320 / 570) + 39 + "px");
    });
  };

  const updateBlueBar = function() {
    var bottom;
    $('#blue_bar').height($('#blue_bar').parent().height());
    bottom = $(window).height() - ($('#blue_bar').position().top + $('#blue_bar').outerHeight(true));
    $('#background_images').css({
      bottom: bottom + "px"
    });
  };

  $(document).ready(function() {
    changeBackgroundImage();
    updateOrbitSize();
    updateBlueBar();
  });
  
  $(window).resize(function() {
    updateOrbitSize();
    updateBlueBar();
  });
});